2025-08-09 14:23:51,719 - INFO - Started server process [27308]
2025-08-09 14:23:51,719 - INFO - Waiting for application startup.
2025-08-09 14:23:51,719 - INFO - Démarrage de l'application... Chargement du modèle d'IA en cours.
2025-08-09 14:23:51,721 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-08-09 14:23:54,653 - INFO - Modèle d'IA chargé avec succès.
2025-08-09 14:23:54,653 - INFO - Exécution d'un test de vérification du modèle...
2025-08-09 14:23:54,824 - INFO - Test de vérification du modèle réussi. Le modèle est opérationnel (vecteur de forme (1, 384)).
2025-08-09 14:23:54,825 - INFO - Application startup complete.
2025-08-09 14:23:54,826 - INFO - Uvicorn running on http://127.0.0.1:5000 (Press CTRL+C to quit)
2025-08-09 14:41:01,176 - INFO - THREAD: Suppression du chapitre 3 pour le roman 1754736984269
2025-08-09 14:41:09,127 - INFO - Données pour le roman 1754736984269 supprimées avec succès.
2025-08-11 18:05:20,352 - INFO - Started server process [32376]
2025-08-11 18:05:20,353 - INFO - Waiting for application startup.
2025-08-11 18:05:20,353 - INFO - Démarrage de l'application... Chargement du modèle d'IA en cours.
2025-08-11 18:05:20,354 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-08-11 18:05:23,386 - INFO - Modèle d'IA chargé avec succès.
2025-08-11 18:05:23,386 - INFO - Exécution d'un test de vérification du modèle...
2025-08-11 18:05:23,569 - INFO - Test de vérification du modèle réussi. Le modèle est opérationnel (vecteur de forme (1, 384)).
2025-08-11 18:05:23,569 - INFO - Application startup complete.
2025-08-11 18:05:23,570 - INFO - Uvicorn running on http://127.0.0.1:5000 (Press CTRL+C to quit)
2025-08-11 18:16:37,533 - INFO - Données pour le roman 1754928304135 supprimées avec succès.
2025-08-11 18:16:37,542 - INFO - THREAD: Ajout d'un chapitre au roman : 1754928304135
2025-08-11 18:16:37,544 - INFO - THREAD: Encodage du texte du chapitre...
2025-08-11 18:16:37,546 - ERROR - Erreur inattendue dans /add_chapter: [Errno 22] Invalid argument
Traceback (most recent call last):
  File "C:\Users\Utilisateur\nihon_quest\backend\app\api\router.py", line 179, in add_chapter
    return await run_in_threadpool(_add_chapter_sync, payload)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\concurrency.py", line 38, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 2470, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 967, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\nihon_quest\backend\app\api\router.py", line 164, in _add_chapter_sync
    embedding = model.encode([payload.chapter_text])
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\sentence_transformers\SentenceTransformer.py", line 1018, in encode
    for start_index in trange(0, len(sentences), batch_size, desc="Batches", disable=not show_progress_bar):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\tqdm\std.py", line 1524, in trange
    return tqdm(range(*args), **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\tqdm\std.py", line 1096, in __init__
    self.sp = self.status_printer(self.fp)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\tqdm\std.py", line 448, in status_printer
    getattr(sys.stderr, 'flush', lambda: None)()
OSError: [Errno 22] Invalid argument
2025-08-11 18:33:10,981 - INFO - Données pour le roman 1754928304135 supprimées avec succès.
2025-08-11 18:33:10,982 - INFO - THREAD: Ajout d'un chapitre au roman : 1754928304135
2025-08-11 18:33:10,983 - INFO - THREAD: Encodage du texte du chapitre...
2025-08-11 18:33:10,985 - ERROR - Erreur inattendue dans /add_chapter: [Errno 22] Invalid argument
Traceback (most recent call last):
  File "C:\Users\Utilisateur\nihon_quest\backend\app\api\router.py", line 179, in add_chapter
    return await run_in_threadpool(_add_chapter_sync, payload)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\concurrency.py", line 38, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 2470, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 967, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\nihon_quest\backend\app\api\router.py", line 164, in _add_chapter_sync
    embedding = model.encode([payload.chapter_text])
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\sentence_transformers\SentenceTransformer.py", line 1018, in encode
    for start_index in trange(0, len(sentences), batch_size, desc="Batches", disable=not show_progress_bar):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\tqdm\std.py", line 1524, in trange
    return tqdm(range(*args), **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\tqdm\std.py", line 1096, in __init__
    self.sp = self.status_printer(self.fp)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\tqdm\std.py", line 448, in status_printer
    getattr(sys.stderr, 'flush', lambda: None)()
OSError: [Errno 22] Invalid argument
2025-08-11 18:33:35,659 - INFO - Données pour le roman 1754928304135 supprimées avec succès.
2025-08-12 20:03:09,278 - INFO - Started server process [22912]
2025-08-12 20:03:09,280 - INFO - Waiting for application startup.
2025-08-12 20:03:09,284 - INFO - Démarrage de l'application... Chargement du modèle d'IA en cours.
2025-08-12 20:03:09,285 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-08-12 20:03:12,840 - INFO - Modèle d'IA chargé avec succès.
2025-08-12 20:03:12,840 - INFO - Exécution d'un test de vérification du modèle...
2025-08-12 20:03:13,066 - INFO - Test de vérification du modèle réussi. Le modèle est opérationnel (vecteur de forme (1, 384)).
2025-08-12 20:03:13,067 - INFO - Application startup complete.
2025-08-12 20:03:13,068 - INFO - Uvicorn running on http://127.0.0.1:5000 (Press CTRL+C to quit)
2025-08-12 20:03:55,282 - INFO - Données pour le roman 1754938833551 supprimées avec succès.
2025-08-12 20:03:55,295 - INFO - THREAD: Ajout d'un chapitre au roman : 1754938833551
2025-08-12 20:03:55,300 - INFO - THREAD: Encodage du texte du chapitre...
2025-08-12 20:03:55,367 - INFO - THREAD: Encodage terminé.
2025-08-12 20:03:55,370 - INFO - Sauvegarde de l'index FAISS (1 vecteurs) dans C:\Users\Utilisateur\nihon_quest\backend\storage\1754938833551\faiss_index.bin
2025-08-12 20:03:55,374 - INFO - Sauvegarde de 1 chapitres dans C:\Users\Utilisateur\nihon_quest\backend\storage\1754938833551\chapters.json
2025-08-12 20:03:55,375 - INFO - Données sauvegardées avec succès pour le roman 1754938833551.
2025-08-12 20:09:25,410 - INFO - Données pour le roman 1754938833551 supprimées avec succès.
2025-08-12 20:09:25,427 - INFO - THREAD: Ajout d'un chapitre au roman : 1754938833551
2025-08-12 20:09:25,432 - INFO - THREAD: Encodage du texte du chapitre...
2025-08-12 20:09:25,461 - ERROR - Erreur inattendue dans /add_chapter: [Errno 22] Invalid argument
Traceback (most recent call last):
  File "C:\Users\Utilisateur\nihon_quest\backend\app\api\router.py", line 179, in add_chapter
    return await run_in_threadpool(_add_chapter_sync, payload)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\concurrency.py", line 38, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 2470, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 967, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\nihon_quest\backend\app\api\router.py", line 164, in _add_chapter_sync
    embedding = model.encode([payload.chapter_text])
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\sentence_transformers\SentenceTransformer.py", line 1018, in encode
    for start_index in trange(0, len(sentences), batch_size, desc="Batches", disable=not show_progress_bar):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\tqdm\std.py", line 1524, in trange
    return tqdm(range(*args), **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\tqdm\std.py", line 1096, in __init__
    self.sp = self.status_printer(self.fp)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\tqdm\std.py", line 448, in status_printer
    getattr(sys.stderr, 'flush', lambda: None)()
OSError: [Errno 22] Invalid argument
2025-08-12 20:09:38,372 - INFO - Données pour le roman 1754938833551 supprimées avec succès.
2025-08-12 20:09:38,377 - INFO - THREAD: Ajout d'un chapitre au roman : 1754938833551
2025-08-12 20:09:38,379 - INFO - THREAD: Encodage du texte du chapitre...
2025-08-12 20:09:38,381 - ERROR - Erreur inattendue dans /add_chapter: [Errno 22] Invalid argument
Traceback (most recent call last):
  File "C:\Users\Utilisateur\nihon_quest\backend\app\api\router.py", line 179, in add_chapter
    return await run_in_threadpool(_add_chapter_sync, payload)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\concurrency.py", line 38, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 2470, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 967, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\nihon_quest\backend\app\api\router.py", line 164, in _add_chapter_sync
    embedding = model.encode([payload.chapter_text])
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\sentence_transformers\SentenceTransformer.py", line 1018, in encode
    for start_index in trange(0, len(sentences), batch_size, desc="Batches", disable=not show_progress_bar):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\tqdm\std.py", line 1524, in trange
    return tqdm(range(*args), **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\tqdm\std.py", line 1096, in __init__
    self.sp = self.status_printer(self.fp)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\tqdm\std.py", line 448, in status_printer
    getattr(sys.stderr, 'flush', lambda: None)()
OSError: [Errno 22] Invalid argument
2025-10-17 18:17:13,367 - INFO - Started server process [31936]
2025-10-17 18:17:13,368 - INFO - Waiting for application startup.
2025-10-17 18:17:13,369 - INFO - Démarrage de l'application... Chargement du modèle d'IA en cours.
2025-10-17 18:17:13,370 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-10-17 18:17:16,713 - INFO - Modèle d'IA chargé avec succès.
2025-10-17 18:17:16,713 - INFO - Exécution d'un test de vérification du modèle...
2025-10-17 18:17:16,879 - INFO - Test de vérification du modèle réussi. Le modèle est opérationnel (vecteur de forme (1, 384)).
2025-10-17 18:17:16,880 - INFO - Application startup complete.
2025-10-17 18:17:16,880 - INFO - Uvicorn running on http://127.0.0.1:5000 (Press CTRL+C to quit)
2025-10-17 19:14:06,328 - INFO - Données pour le roman 1755705826009 supprimées avec succès.
2025-10-17 19:14:06,335 - INFO - THREAD: Ajout d'un chapitre au roman : 1755705826009
2025-10-17 19:14:06,343 - INFO - THREAD: Encodage du texte du chapitre...
2025-10-17 19:14:06,404 - ERROR - Erreur inattendue dans /add_chapter: [Errno 22] Invalid argument
Traceback (most recent call last):
  File "C:\Users\Utilisateur\nihon_quest\backend\app\api\router.py", line 177, in add_chapter
    distances, found_ids = index.search(query_vec, k) # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\concurrency.py", line 38, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 2470, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 967, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\nihon_quest\backend\app\api\router.py", line 162, in _add_chapter_sync
    raise HTTPException(status_code=500, detail="Erreur interne du serveur lors de l'ajout du chapitre.")
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\sentence_transformers\SentenceTransformer.py", line 1018, in encode
    for start_index in trange(0, len(sentences), batch_size, desc="Batches", disable=not show_progress_bar):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\tqdm\std.py", line 1524, in trange
    return tqdm(range(*args), **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\tqdm\std.py", line 1096, in __init__
    self.sp = self.status_printer(self.fp)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\tqdm\std.py", line 448, in status_printer
    getattr(sys.stderr, 'flush', lambda: None)()
OSError: [Errno 22] Invalid argument
2025-10-17 19:28:48,802 - INFO - Démarrage de l'application... Chargement du modèle d'IA en cours.
2025-10-17 19:28:48,803 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-10-17 19:28:51,726 - INFO - Modèle d'IA chargé avec succès.
2025-10-17 19:28:51,726 - INFO - Exécution d'un test de vérification du modèle...
2025-10-17 19:28:51,780 - INFO - Test de vérification du modèle réussi. Le modèle est opérationnel (vecteur de forme (1, 384)).
2025-10-17 19:45:14,492 - INFO - Extinction de l'application... Nettoyage des modèles.
2025-10-17 19:45:14,492 - INFO - Nettoyage terminé.
2025-10-17 19:45:22,151 - INFO - Démarrage de l'application... Chargement du modèle d'IA en cours.
2025-10-17 19:45:22,153 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-10-17 19:45:25,407 - INFO - Modèle d'IA chargé avec succès.
2025-10-17 19:45:25,408 - INFO - Exécution d'un test de vérification du modèle...
2025-10-17 19:45:25,428 - INFO - Test de vérification du modèle réussi. Le modèle est opérationnel (vecteur de forme (1, 384)).
2025-10-17 19:45:38,528 - INFO - HTTP Request: POST https://openrouter.ai/api/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-10-17 19:45:38,528 - WARNING - Clé API (index 0) a atteint son quota. Essai de la suivante.
2025-10-17 19:45:39,293 - INFO - HTTP Request: POST https://openrouter.ai/api/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-10-17 19:45:39,293 - WARNING - Clé API (index 1) a atteint son quota. Essai de la suivante.
2025-10-17 19:45:39,887 - INFO - HTTP Request: POST https://openrouter.ai/api/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-10-17 19:45:39,887 - WARNING - Clé API (index 2) a atteint son quota. Essai de la suivante.
2025-10-17 19:50:21,659 - INFO - Extinction de l'application... Nettoyage des modèles.
2025-10-17 19:50:21,659 - INFO - Nettoyage terminé.
2025-10-17 19:50:29,054 - INFO - Démarrage de l'application... Chargement du modèle d'IA en cours.
2025-10-17 19:50:29,056 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-10-17 19:50:31,636 - INFO - Modèle d'IA chargé avec succès.
2025-10-17 19:50:31,637 - INFO - Exécution d'un test de vérification du modèle...
2025-10-17 19:50:31,655 - INFO - Test de vérification du modèle réussi. Le modèle est opérationnel (vecteur de forme (1, 384)).
2025-10-17 19:50:44,683 - INFO - HTTP Request: POST https://openrouter.ai/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-17 20:06:52,186 - INFO - HTTP Request: POST https://openrouter.ai/api/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-10-17 20:06:52,186 - WARNING - Clé API (index 0) a atteint son quota. Essai de la suivante.
2025-10-17 20:06:53,952 - INFO - HTTP Request: POST https://openrouter.ai/api/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-10-17 20:06:53,952 - WARNING - Clé API (index 1) a atteint son quota. Essai de la suivante.
2025-10-17 20:06:54,559 - INFO - HTTP Request: POST https://openrouter.ai/api/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-10-17 20:06:54,559 - WARNING - Clé API (index 2) a atteint son quota. Essai de la suivante.
2025-10-17 20:07:10,641 - INFO - Extinction de l'application... Nettoyage des modèles.
2025-10-17 20:07:10,641 - INFO - Nettoyage terminé.
2025-10-17 20:07:17,874 - INFO - Démarrage de l'application... Chargement du modèle d'IA en cours.
2025-10-17 20:07:17,875 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-10-17 20:07:20,764 - INFO - Modèle d'IA chargé avec succès.
2025-10-17 20:07:20,764 - INFO - Exécution d'un test de vérification du modèle...
2025-10-17 20:07:20,785 - INFO - Test de vérification du modèle réussi. Le modèle est opérationnel (vecteur de forme (1, 384)).
2025-10-17 20:09:13,398 - INFO - HTTP Request: POST https://openrouter.ai/api/v1/chat/completions "HTTP/1.1 404 Not Found"
2025-10-17 20:12:43,899 - INFO - HTTP Request: POST https://openrouter.ai/api/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-10-17 20:12:43,900 - WARNING - Clé API (index 0) a atteint son quota. Essai de la suivante.
2025-10-17 20:12:45,792 - INFO - HTTP Request: POST https://openrouter.ai/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-17 20:16:56,511 - INFO - HTTP Request: POST https://openrouter.ai/api/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-10-17 20:16:56,511 - WARNING - Clé API (index 1) a atteint son quota. Essai de la suivante.
2025-10-17 20:16:58,116 - INFO - HTTP Request: POST https://openrouter.ai/api/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-10-17 20:16:58,116 - WARNING - Clé API (index 2) a atteint son quota. Essai de la suivante.
2025-10-17 20:16:59,490 - INFO - HTTP Request: POST https://openrouter.ai/api/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-10-17 20:16:59,491 - WARNING - Clé API (index 0) a atteint son quota. Essai de la suivante.
2025-10-17 20:17:11,592 - INFO - Extinction de l'application... Nettoyage des modèles.
2025-10-17 20:17:11,592 - INFO - Nettoyage terminé.
2025-10-17 20:17:18,914 - INFO - Démarrage de l'application... Chargement du modèle d'IA en cours.
2025-10-17 20:17:18,915 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-10-17 20:17:21,977 - INFO - Modèle d'IA chargé avec succès.
2025-10-17 20:17:21,977 - INFO - Exécution d'un test de vérification du modèle...
2025-10-17 20:17:22,001 - INFO - Test de vérification du modèle réussi. Le modèle est opérationnel (vecteur de forme (1, 384)).
2025-10-17 20:17:56,150 - INFO - HTTP Request: POST https://openrouter.ai/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-17 20:30:28,231 - INFO - Données pour le roman 1755705826009 supprimées avec succès.
2025-10-17 20:30:51,268 - INFO - HTTP Request: POST https://openrouter.ai/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-17 20:30:52,083 - INFO - THREAD: Ajout d'un chapitre au roman : 1a2c505d-e027-408e-8c73-6b2255ed2d1b
2025-10-17 20:30:52,084 - INFO - THREAD: Encodage du texte du chapitre...
2025-10-17 20:30:52,095 - INFO - THREAD: Encodage terminé.
2025-10-17 20:30:52,098 - INFO - Sauvegarde de l'index FAISS (1 vecteurs) dans C:\Users\Utilisateur\nihon_quest\backend\storage\1a2c505d-e027-408e-8c73-6b2255ed2d1b\faiss_index.bin
2025-10-17 20:30:52,101 - INFO - Sauvegarde de 1 chapitres dans C:\Users\Utilisateur\nihon_quest\backend\storage\1a2c505d-e027-408e-8c73-6b2255ed2d1b\chapters.json
2025-10-17 20:30:52,101 - INFO - Données sauvegardées avec succès pour le roman 1a2c505d-e027-408e-8c73-6b2255ed2d1b.
2025-10-17 20:31:11,649 - INFO - HTTP Request: POST https://openrouter.ai/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-17 20:33:09,156 - INFO - THREAD: Suppression optimisée du chapitre 0 pour le roman 1a2c505d-e027-408e-8c73-6b2255ed2d1b
2025-10-17 20:33:09,177 - INFO - Données pour le roman 1a2c505d-e027-408e-8c73-6b2255ed2d1b supprimées avec succès.
2025-10-17 20:33:20,016 - INFO - Données pour le roman 1a2c505d-e027-408e-8c73-6b2255ed2d1b supprimées avec succès.
2025-10-17 20:36:19,260 - INFO - HTTP Request: POST https://openrouter.ai/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-17 20:36:37,886 - INFO - THREAD: Ajout d'un chapitre au roman : 3c2c41eb-121d-4fc1-83bc-e314c220d503
2025-10-17 20:36:37,886 - INFO - THREAD: Encodage du texte du chapitre...
2025-10-17 20:36:37,932 - INFO - THREAD: Encodage terminé.
2025-10-17 20:36:37,933 - INFO - Sauvegarde de l'index FAISS (1 vecteurs) dans C:\Users\Utilisateur\nihon_quest\backend\storage\3c2c41eb-121d-4fc1-83bc-e314c220d503\faiss_index.bin
2025-10-17 20:36:37,933 - INFO - Sauvegarde de 1 chapitres dans C:\Users\Utilisateur\nihon_quest\backend\storage\3c2c41eb-121d-4fc1-83bc-e314c220d503\chapters.json
2025-10-17 20:36:37,934 - INFO - Données sauvegardées avec succès pour le roman 3c2c41eb-121d-4fc1-83bc-e314c220d503.
2025-10-17 20:38:29,313 - INFO - Données pour le roman 3c2c41eb-121d-4fc1-83bc-e314c220d503 supprimées avec succès.
2025-10-17 20:38:29,319 - INFO - THREAD: Ajout d'un chapitre au roman : 3c2c41eb-121d-4fc1-83bc-e314c220d503
2025-10-17 20:38:29,320 - INFO - THREAD: Encodage du texte du chapitre...
2025-10-17 20:38:29,351 - INFO - THREAD: Encodage terminé.
2025-10-17 20:38:29,351 - INFO - Sauvegarde de l'index FAISS (1 vecteurs) dans C:\Users\Utilisateur\nihon_quest\backend\storage\3c2c41eb-121d-4fc1-83bc-e314c220d503\faiss_index.bin
2025-10-17 20:38:29,352 - INFO - Sauvegarde de 1 chapitres dans C:\Users\Utilisateur\nihon_quest\backend\storage\3c2c41eb-121d-4fc1-83bc-e314c220d503\chapters.json
2025-10-17 20:38:29,353 - INFO - Données sauvegardées avec succès pour le roman 3c2c41eb-121d-4fc1-83bc-e314c220d503.
2025-10-17 20:39:11,211 - INFO - Extinction de l'application... Nettoyage des modèles.
2025-10-17 20:39:11,211 - INFO - Nettoyage terminé.
2025-10-18 02:26:29,449 - INFO - Données pour le roman 1755705826009 supprimées avec succès.
2025-10-18 02:26:29,456 - INFO - THREAD: Ajout d'un chapitre au roman : 1755705826009
2025-10-18 02:26:29,462 - INFO - THREAD: Encodage du texte du chapitre...
2025-10-18 02:26:29,499 - ERROR - Erreur inattendue dans /add_chapter: [Errno 22] Invalid argument
Traceback (most recent call last):
  File "C:\Users\Utilisateur\nihon_quest\backend\app\api\router.py", line 177, in add_chapter
    }
      
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\concurrency.py", line 38, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 2470, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 967, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\nihon_quest\backend\app\api\router.py", line 162, in _add_chapter_sync
    for i in range(len(OPENROUTER_API_KEYS)):
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\sentence_transformers\SentenceTransformer.py", line 1018, in encode
    for start_index in trange(0, len(sentences), batch_size, desc="Batches", disable=not show_progress_bar):
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\tqdm\std.py", line 1524, in trange
    return tqdm(range(*args), **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\tqdm\std.py", line 1096, in __init__
    self.sp = self.status_printer(self.fp)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Utilisateur\AppData\Local\Programs\Python\Python311\Lib\site-packages\tqdm\std.py", line 448, in status_printer
    getattr(sys.stderr, 'flush', lambda: None)()
OSError: [Errno 22] Invalid argument
